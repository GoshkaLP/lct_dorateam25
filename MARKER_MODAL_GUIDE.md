# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –ø—Ä–∏–≤—è–∑–∫–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –∫ –º–∞—Ä–∫–µ—Ä–∞–º

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–æ—Ç–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø—Ä–∏–≤—è–∑–∫–∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –∫ –º–∞—Ä–∫–µ—Ä–∞–º –Ω–∞ –Ø–Ω–¥–µ–∫—Å –∫–∞—Ä—Ç–∞—Ö. –°–∏—Å—Ç–µ–º–∞ –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —É–º–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–∞—Ä—Ç—ã –∏ –ø—Ä–æ—Å—Ç–æ–µ API –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. –•—É–∫ `useMarkerPosition`
–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –ø–∏–∫—Å–µ–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –º–∞—Ä–∫–µ—Ä–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –µ—ë –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–∞—Ä—Ç—ã.

### 2. –•—É–∫ `useMarkerModal` 
–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ö—É–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ–≥–æ –∫ –º–∞—Ä–∫–µ—Ä—É.

### 3. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç `MarkerModal`
–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å —É–º–Ω—ã–º –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```tsx
import React from 'react'
import { useMarkerModal, MarkerModal } from './hooks'

const MyMapComponent = () => {
  const mapRef = useRef<any>(null)

  // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –º–∞—Ä–∫–µ—Ä–∞
  const { isVisible, position, openModal, closeModal, handleMarkerClick } = useMarkerModal({
    mapInstance: mapRef.current,
    coordinates: [37.617635, 55.755814], // [–¥–æ–ª–≥–æ—Ç–∞, —à–∏—Ä–æ—Ç–∞]
    autoOpenOnClick: true
  })

  // –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –º–∞—Ä–∫–µ—Ä–∞ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞
  useEffect(() => {
    if (mapRef.current) {
      const marker = new YMapDefaultMarker({
        coordinates: [37.617635, 55.755814]
      })
      
      marker.addEventListener('click', handleMarkerClick)
      mapRef.current.addChild(marker)
    }
  }, [handleMarkerClick])

  return (
    <div>
      {/* –í–∞—à–∞ –∫–∞—Ä—Ç–∞ */}
      <div ref={mapRef} />
      
      {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ */}
      <MarkerModal isVisible={isVisible} onClose={closeModal} position={position}>
        <div className="p-4">
          <h3 className="text-lg font-semibold mb-2">–ó–∞–≥–æ–ª–æ–≤–æ–∫</h3>
          <p>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞</p>
        </div>
      </MarkerModal>
    </div>
  )
}
```

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```tsx
import React from 'react'
import { useMarkerModal } from './hooks'

const AdvancedMapComponent = () => {
  const mapRef = useRef<any>(null)

  // –ú–∞—Ä–∫–µ—Ä 1 - –ö—Ä–µ–º–ª—å
  const kremlinModal = useMarkerModal({
    mapInstance: mapRef.current,
    coordinates: [37.617635, 55.755814],
    autoOpenOnClick: true
  })

  // –ú–∞—Ä–∫–µ—Ä 2 - –ö—Ä–∞—Å–Ω–∞—è –ø–ª–æ—â–∞–¥—å  
  const redSquareModal = useMarkerModal({
    mapInstance: mapRef.current,
    coordinates: [37.6205, 55.7539],
    autoOpenOnClick: true
  })

  return (
    <div>
      <div ref={mapRef} />
      
      {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ö—Ä–µ–º–ª—è */}
      <MarkerModal 
        isVisible={kremlinModal.isVisible} 
        onClose={kremlinModal.closeModal} 
        position={kremlinModal.position}
        className="w-96"
      >
        <div className="p-6">
          <h3 className="text-xl font-bold mb-3">üè∞ –ú–æ—Å–∫–æ–≤—Å–∫–∏–π –ö—Ä–µ–º–ª—å</h3>
          <p className="text-gray-700">–†–µ–∑–∏–¥–µ–Ω—Ü–∏—è –ü—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞ –†–§</p>
        </div>
      </MarkerModal>

      {/* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –ö—Ä–∞—Å–Ω–æ–π –ø–ª–æ—â–∞–¥–∏ */}
      <MarkerModal 
        isVisible={redSquareModal.isVisible} 
        onClose={redSquareModal.closeModal} 
        position={redSquareModal.position}
      >
        <div className="p-4">
          <h3 className="text-lg font-semibold mb-2">üü• –ö—Ä–∞—Å–Ω–∞—è –ø–ª–æ—â–∞–¥—å</h3>
          <p className="text-sm text-gray-600">–ì–ª–∞–≤–Ω–∞—è –ø–ª–æ—â–∞–¥—å –ú–æ—Å–∫–≤—ã</p>
        </div>
      </MarkerModal>
    </div>
  )
}
```

## API

### `useMarkerModal(options)`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `mapInstance` - —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–∞—Ä—Ç—ã Yandex Maps
- `coordinates` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –º–∞—Ä–∫–µ—Ä–∞ `[–¥–æ–ª–≥–æ—Ç–∞, —à–∏—Ä–æ—Ç–∞]`
- `autoOpenOnClick?` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –ø—Ä–∏ –∫–ª–∏–∫–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `true`)
- `autoCloseOnOutsideClick?` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –æ–∫–Ω–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `true`)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
- `isVisible` - –æ—Ç–∫—Ä—ã—Ç–æ –ª–∏ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
- `position` - –ø–æ–∑–∏—Ü–∏—è –æ–∫–Ω–∞ `{x: number, y: number}`
- `openModal()` - —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è
- `closeModal()` - —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è
- `toggleModal()` - —Ñ—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
- `handleMarkerClick()` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –º–∞—Ä–∫–µ—Ä–∞

### `MarkerModal` –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

**–ü—Ä–æ–ø—ã:**
- `isVisible` - –æ—Ç–∫—Ä—ã—Ç–æ –ª–∏ –æ–∫–Ω–æ
- `onClose` - —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è
- `position?` - –ø–æ–∑–∏—Ü–∏—è –æ–∫–Ω–∞
- `className?` - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ CSS –∫–ª–∞—Å—Å—ã
- `children` - –∫–æ–Ω—Ç–µ–Ω—Ç –æ–∫–Ω–∞

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

### –£–º–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–º–µ—â–∞–µ—Ç –æ–∫–Ω–æ —Å–≤–µ—Ä—Ö—É –∏–ª–∏ —Å–Ω–∏–∑—É –æ—Ç –º–∞—Ä–∫–µ—Ä–∞
- –£—á–∏—Ç—ã–≤–∞–µ—Ç –≥—Ä–∞–Ω–∏—Ü—ã —ç–∫—Ä–∞–Ω–∞
- –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∑–∞ –∫—Ä–∞—è
- Fallback –≤ —Ü–µ–Ω—Ç—Ä —ç–∫—Ä–∞–Ω–∞ –ø—Ä–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–∞—Ä—Ç—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ø—Ä–∏ –∑—É–º–µ
- –†–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫–∞—Ä—Ç—ã  
- –°–ª—É—à–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã

### –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
- Responsive –¥–∏–∑–∞–π–Ω
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è—Ö

## –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è

–ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç Tailwind CSS –∫–ª–∞—Å—Å—ã. –ú–æ–∂–Ω–æ –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å:

```tsx
<MarkerModal 
  className="w-80 bg-blue-50 border-blue-200"
  // ...–¥—Ä—É–≥–∏–µ –ø—Ä–æ–ø—ã
>
  <div className="p-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-t-lg">
    <h3>–ö–∞—Å—Ç–æ–º–Ω—ã–π —Å—Ç–∏–ª—å</h3>
  </div>
</MarkerModal>
```

## –°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

1. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã**: –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ö—É–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞—Ä–∫–µ—Ä–∞
2. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `React.memo` –¥–ª—è —Ç—è–∂–µ–ª–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
3. **–î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å**: –î–æ–±–∞–≤–ª—è–π—Ç–µ `aria-label` –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–Ω—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é
4. **–ú–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**: –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö —ç–∫—Ä–∞–Ω–∞

## –ü—Ä–∏–º–µ—Ä —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

```tsx
const CitiesMap = () => {
  const cities = [
    { id: 1, name: '–ú–æ—Å–∫–≤–∞', coords: [37.617635, 55.755814] },
    { id: 2, name: '–°–ü–±', coords: [30.3609, 59.9311] },
    { id: 3, name: '–ö–∞–∑–∞–Ω—å', coords: [49.1221, 55.7887] }
  ]

  const modals = cities.map(city => ({
    city,
    modal: useMarkerModal({
      mapInstance: mapRef.current,
      coordinates: city.coords
    })
  }))

  return (
    <div>
      <div ref={mapRef} />
      
      {modals.map(({ city, modal }) => (
        <MarkerModal key={city.id} {...modal}>
          <div className="p-4">
            <h3>{city.name}</h3>
            <button onClick={() => loadCityData(city.id)}>
              –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
            </button>
          </div>
        </MarkerModal>
      ))}
    </div>
  )
}
```

## –û—Ç–ª–∞–¥–∫–∞

–î–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `KremlinModal` –µ—Å—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞—Ö:

```tsx
<div className="mt-2 text-xs text-gray-400">
  –ü–æ–∑–∏—Ü–∏—è: x={position?.x?.toFixed(0)}, y={position?.y?.toFixed(0)}
</div>
```

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –≤–∫–ª—é—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞.
